tasks:
  -
    name: main
    default: true
    language: Bash
    config:
      version: 2022.07
    code: |
      set -e

      version=$(config version)
      echo "Use rakudo version: $version"
      eval "$(~/.rakubrew/bin/rakubrew init Bash)"
      rakubrew download moar-$version
      rakubrew switch moar-$version
      ls -l ~/.rakubrew/versions/moar-$version/bin/
      
      cd source
      stat ~/.rakubrew/versions/moar-$version/bin/rakudo
      file ~/.rakubrew/versions/moar-$version/bin/rakudo
      
      ~/.rakubrew/versions/moar-$version/bin/rakudo --version
      which zef
      which raku
      which rakudo
      
      rakudo  --version
      raku --version
      zef --version

      zef update 
      zef install --/test .

    depends:
      -
        name: rakubrew-install
  -
    name: rakubrew-install
    language: Bash
    code: |
      set -e
      curl -s https://rakubrew.org/install-on-perl.sh | sh
